{
  "version": 3,
  "sources": ["../../shared/src/index.ts", "../src/effect.ts", "../src/bacehander.ts", "../src/reactive.ts"],
  "sourcesContent": ["export function isObject(value){\r\n    return typeof value === \"object\" && value !== null;\r\n}", "\r\n\r\n//\u521B\u5EFA\u4E00\u4E2A\u54CD\u5E94\u5F0Feffect \u6570\u636E\u53D8\u5316\u53EF\u4EE5\u91CD\u65B0\u6267\u884C\r\nexport function effect(fn, options?) {\r\n\r\n    //\u521B\u5EFA\u4E00\u4E2Aeffect,\u53EA\u7528\u4F9D\u8D56\u7684\u5C5E\u6027\u53D8\u5316\u4E86\u5C31\u8981\u6267\u884C\u56DE\u8C03\r\n    const _effect = new ReactiveEffect(fn, () => {\r\n        //scheduler \u8C03\u5EA6\u51FD\u6570\r\n        _effect.run()\r\n    })\r\n    _effect.run() //effect\u7ACB\u5373\u6267\u884C\u4E00\u6B21\r\n}\r\n\r\nexport let activeEffect;\r\n\r\nclass ReactiveEffect {\r\n    public active = true; // \u6807\u8BB0\u521B\u5EFA\u7684effect\u662F\u54CD\u5E94\u5F0F\u7684\r\n    // fn \u7528\u6237\u4F20\u5165\u51FD\u6570\r\n    // \u5982\u679Cfn\u4E2D\u4F9D\u8D56\u7684\u6570\u636E\u53D8\u5316\u9700\u8981\u91CD\u65B0\u8C03\u7528 run->\r\n    constructor(public fn, public scheduler) {\r\n\r\n    }\r\n    run() {\r\n        //\u8BA9fn\u6267\u884C\r\n        if (!this.active) return this.fn();\r\n        let lastactiveEffect = activeEffect; // \u89C4\u907F\u9012\u5F52\u8C03\u7528effect\u5BFC\u81F4this\u4E0D\u5BF9\uFF0C\u4E5F\u53EF\u4EE5\u7528\u6808\u8C03\u7528\u89E3\u51B3\r\n        try{   \r\n        activeEffect = this;\r\n        return this.fn(); //\u505A\u4F9D\u8D56\u6536\u96C6 -> state.name state.age\r\n        }finally{\r\n            activeEffect = lastactiveEffect;\r\n        }\r\n    }\r\n}\r\n", "import {activeEffect} from \"./effect\"\r\n\r\nexport enum ReactiveFlags{\r\n    IS_REACTIVE = \"__v_isReactive\"\r\n}\r\n\r\n// proxy \u642D\u914Dfeflect\u4F7F\u7528 \u53CD\u5C04\uFF1A\u5728\u4EE3\u7801\u6267\u884C\u65F6\u80FD\u4FEE\u6539\u4EE3\u7801\u7684\u6267\u884C\u884C\u4E3A\r\nexport const mutableHanders:ProxyHandler<any>={\r\n    get(target,key,recevier){\r\n        if(key=== ReactiveFlags.IS_REACTIVE) return true;\r\n        // \u5F53\u53D6\u503C\u65F6 \u8BA9\u54CD\u5E94\u5F0F\u5C5E\u6027\u548Ceffect\u6620\u5C04\u8D77\u6765\r\n        // \u4F9D\u8D56\u6536\u96C6todo...\r\n        console.log(activeEffect,key)\r\n        return Reflect.get(target,key,recevier) //recevier\u5C31\u662F\u4EE3\u7406\u5BF9\u8C61\r\n        // \u4E0D\u80FD\u76F4\u63A5return target[key]\uFF0C\u5982\u679C\u4EE3\u7406\u5BF9\u8C61\u5BF9\u8C61\u4E2D\u6709this\u4F1A\u6B7B\u5FAA\u73AF \r\n    },\r\n    set(target,key,value,recevier){\r\n        // \u89E6\u53D1\u66F4\u65B0\r\n        return true; \r\n    },\r\n}", "import { isObject } from \"@vue/shared\";\r\nimport { mutableHanders, ReactiveFlags } from \"./bacehander\";\r\n\r\nconst reactiveMap = new WeakMap(); //\u7F13\u5B58\u4EE3\u7406\u5BF9\u8C61\r\n\r\n\r\nfunction createReactiveObject(target){\r\n    //\u7EDF\u4E00\u5224\u65AD\uFF0C\u54CD\u5E94\u5F0F\u5BF9\u8C61\u5FC5\u987B\u662F\u5BF9\u8C61\r\n    if(!isObject(target)) return;\r\n    if(target[ReactiveFlags.IS_REACTIVE])return target;\r\n\r\n    const exitProxy = reactiveMap.get(target)\r\n    if(exitProxy){ //\u5982\u679C\u7F13\u5B58\u4E2D\u547D\u4E2D\uFF0C\u5219\u76F4\u63A5\u8FD4\u56DE\u4EE3\u7406\u540E\u7684\u5BF9\u8C61\r\n        return exitProxy;\r\n    }\r\n    //\u9700\u8981\u4EE3\u7406\uFF0C\u5C31\u7528proxy\r\n    new Proxy(target,mutableHanders);\r\n    //\u7F13\u5B58\u4EE3\u7406\u8FC7\u7684\u5BF9\u8C61\uFF0C\u76EE\u7684\u662F\u4E3A\u4E86\u533A\u522B\u91CD\u590D\u4EE3\u7406\r\n    reactiveMap.set(target,Proxy)\r\n    return Proxy;\r\n    \r\n} \r\n\r\nexport function reactive(target){\r\n    return createReactiveObject(target);\r\n}"],
  "mappings": ";AAAO,SAAS,SAAS,OAAM;AAC3B,SAAO,OAAO,UAAU,YAAY,UAAU;AAClD;;;ACCO,SAAS,OAAO,IAAI,SAAU;AAGjC,QAAM,UAAU,IAAI,eAAe,IAAI,MAAM;AAEzC,YAAQ,IAAI;AAAA,EAChB,CAAC;AACD,UAAQ,IAAI;AAChB;AAEO,IAAI;AAEX,IAAM,iBAAN,MAAqB;AAAA;AAAA;AAAA;AAAA,EAIjB,YAAmB,IAAW,WAAW;AAAtB;AAAW;AAH9B,SAAO,SAAS;AAAA,EAKhB;AAAA,EACA,MAAM;AAEF,QAAI,CAAC,KAAK,OAAQ,QAAO,KAAK,GAAG;AACjC,QAAI,mBAAmB;AACvB,QAAG;AACH,qBAAe;AACf,aAAO,KAAK,GAAG;AAAA,IACf,UAAC;AACG,qBAAe;AAAA,IACnB;AAAA,EACJ;AACJ;;;AC1BO,IAAM,iBAAiC;AAAA,EAC1C,IAAI,QAAO,KAAI,UAAS;AACpB,QAAG,QAAO,mCAA2B,QAAO;AAG5C,YAAQ,IAAI,cAAa,GAAG;AAC5B,WAAO,QAAQ,IAAI,QAAO,KAAI,QAAQ;AAAA,EAE1C;AAAA,EACA,IAAI,QAAO,KAAI,OAAM,UAAS;AAE1B,WAAO;AAAA,EACX;AACJ;;;ACjBA,IAAM,cAAc,oBAAI,QAAQ;AAGhC,SAAS,qBAAqB,QAAO;AAEjC,MAAG,CAAC,SAAS,MAAM,EAAG;AACtB,MAAG,yCAAgC,EAAE,QAAO;AAE5C,QAAM,YAAY,YAAY,IAAI,MAAM;AACxC,MAAG,WAAU;AACT,WAAO;AAAA,EACX;AAEA,MAAI,MAAM,QAAO,cAAc;AAE/B,cAAY,IAAI,QAAO,KAAK;AAC5B,SAAO;AAEX;AAEO,SAAS,SAAS,QAAO;AAC5B,SAAO,qBAAqB,MAAM;AACtC;",
  "names": []
}
